SELECT city.name AS name_of_city, country.name AS name_of_country FROM country JOIN city ON country.code = city.countrycode;
SELECT country.continent AS name_of_continent, city.name AS name_of_city, city.population AS city_population FROM country JOIN city ON country.code = city.countrycode WHERE country.name = "Germany";
SELECT country.name AS name_of_country, city.name AS name_of_city FROM country JOIN city ON country.capital = city.id ORDER BY country.name;
SELECT country.name AS name_of_country, countrylanguage.language AS language_of_country FROM country JOIN countrylanguage ON country.code = countrylanguage.countrycode WHERE countrylanguage.isofficial = "T";
SELECT country.name AS name_of_country, COUNT(countrylanguage.language) AS number_of_language from country join countrylanguage on country.code = countrylanguage.countrycode GROUP BY country.name ORDER BY number_of_language DESC;
SELECT country.continent AS name_of_continent, country.name AS name_of_country, city.population AS population_of_city FROM country JOIN city on country.capital = city.id ORDER BY population_of_city DESC LIMIT 5;
SELECT country.continent AS name_of_continent, country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.code = city.countrycode WHERE country.continent = "South America";
SELECT country.name AS name_of_country, country.population AS total_population, countrylanguage.language AS language_of_country FROM country JOIN countrylanguage ON country.code = countrylanguage.countrycode ORDER BY country.name, countrylanguage.language;
SELECT country.name AS name_of_country, country.population AS total_population, COUNT(countrylanguage.language) AS number_of_languages FROM country JOIN countrylanguage ON country.code = countrylanguage.countrycode GROUP BY country.name, country.population ORDER BY number_of_languages;
SELECT country.name AS name_of_country, city.name AS name_of_city, countrylanguage.language AS language_of_country FROM country JOIN city ON country.capital = city.id JOIN countrylanguage ON country.code = countrylanguage.countrycode WHERE countrylanguage.isofficial = "T" AND countrylanguage.language = "FRENCH";
SELECT country.continent AS name_of_continent, COUNT(city.id) AS number_of_cities FROM country JOIN city ON country.capital = city.id GROUP BY country.continent;
SELECT country.name AS name_of_country, AVG(city.population) AS average_population_of_city FROM country JOIN city ON country.code = city.countrycode GROUP BY country.name;
SELECT country.continent AS name_of_continent, country.population AS total_population FROM country ORDER BY population DESC LIMIT 1;
WITH country_language AS (SELECT country.name AS name_of_country, COUNT(countrylanguage.language) AS number_of_language FROM country JOIN countrylanguage ON country.code = countrylanguage.countrycode GROUP BY country.name) SELECT name_of_country, number_of_language FROM country_language WHERE number_of_language > 5;
WITH city_population AS(SELECT country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id) SELECT name_of_country, name_of_country, population_of_city FROM city_population ORDER BY population_of_city DESC LIMIT 10;
WITH city_number AS(SELECT country.name AS name_of_country, COUNT(city.id) AS number_of_cities FROM city JOIN country ON country.code = city.countrycode WHERE city.population > 1000000 GROUP BY country.name) SELECT name_of_country, number_of_cities FROM city_number;
WITH city_population_with_continent AS(SELECT country.continent AS name_of_continent, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.code = city.countrycode) SELECT name_of_continent, name_of_city, population_of_city FROM city_population_with_continent WHERE population_of_city = (SELECT MAX(c2.population) FROM city c2 JOIN country co2 ON c2.countrycode = co2.code WHERE co2.continent = name_of_continent);
SELECT language, COUNT(DISTINCT countrycode) AS country_count FROM countrylanguage GROUP BY language HAVING country_count > 10;
SELECT country.name AS name_of_country, city.name AS name_of_city, countrylanguage.language AS language_of_country FROM country JOIN city ON country.capital = city.id JOIN countrylanguage ON country.code = countrylanguage.countrycode WHERE countrylanguage.isofficial = "F" ORDER BY country.name, countrylanguage.language;
SELECT country.name AS name_of_country, country.continent AS name_of_continent, city.name AS name_of_city FROM country JOIN city ON country.capital = city.id JOIN countrylanguage ON country.code = countrylanguage.countrycode WHERE countrylanguage.language = "English";
SELECT country.name AS name_of_country, COUNT(DISTINCT countrylanguage.language) AS count_of_language FROM country JOIN countrylanguage ON country.code = countrylanguage.countrycode GROUP BY country.name;
SELECT country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id WHERE country.continent = "Asia";
SELECT country.continent AS name_of_continent, country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id WHERE city.population > 2000000;
SELECT DISTINCT c.name, c.region, ci.name FROM country c JOIN city ci ON c.capital = ci.id WHERE EXISTS ( SELECT 1 FROM countrylanguage cl WHERE cl.countrycode = c.code AND cl.language = 'Spanish' );
SELECT country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id ORDER BY city.population DESC;
SELECT country.name, city.name, countrylanguage.language FROM country JOIN city ON country.capital = city.id JOIN countrylanguage ON country.code = countrylanguage.countrycode WHERE countrylanguage.isofficial = "T" AND country.continent = "Europe";
SELECT country.name AS name_of_country, country.population AS total_population, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id;
SELECT country.name AS name_of_country, city.name AS name_of_city, city.population AS population_of_city FROM country JOIN city ON country.capital = city.id WHERE city.population < 0.05 * country.population;
SELECT c.name AS country_name, c.region AS region_name, x.name AS city_name, x.population FROM (SELECT ct.*, RANK() OVER (PARTITION BY ct.countrycode ORDER BY ct.population DESC) AS rnk FROM city ct) x JOIN country c ON c.code = x.countrycode WHERE x.rnk = 1 ORDER BY c.name, c.region;
SELECT country.continent AS name_of_continent, city.name AS name_of_city, city.population AS population_of_city FROM city JOIN country ON city.countrycode = country.code WHERE city.population = (SELECT MAX(c2.population) FROM city c2 JOIN country co2 ON c2.countrycode = co2.code WHERE co2.continent = country.continent) ORDER BY country.continent, city.population DESC;
SELECT country.name AS name_of_country FROM country JOIN city ON country.capital = city.id WHERE city.population > 0.5 * country.population;
SELECT countrylanguage.language AS language_of_country FROM countrylanguage JOIN country ON countrylanguage.countrycode = country.code WHERE country.name = ( SELECT name FROM country ORDER BY lifeexpectancy DESC LIMIT 1) AND countrylanguage.isofficial = 'T';